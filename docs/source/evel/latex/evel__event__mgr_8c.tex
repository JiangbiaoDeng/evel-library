\hypertarget{evel__event__mgr_8c}{}\section{evel\+\_\+event\+\_\+mgr.\+c File Reference}
\label{evel__event__mgr_8c}\index{evel\+\_\+event\+\_\+mgr.\+c@{evel\+\_\+event\+\_\+mgr.\+c}}


Event Manager.  


{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$assert.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$pthread.\+h$>$}\newline
{\ttfamily \#include $<$curl/curl.\+h$>$}\newline
{\ttfamily \#include \char`\"{}evel.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}evel\+\_\+internal.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}ring\+\_\+buffer.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}evel\+\_\+throttle.\+h\char`\"{}}\newline
Include dependency graph for evel\+\_\+event\+\_\+mgr.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{evel__event__mgr_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{evel_8h_ae1f68b0d21fb98defcec46e99208a03e}{E\+V\+E\+L\+\_\+\+E\+R\+R\+\_\+\+C\+O\+D\+ES} \hyperlink{evel__event__mgr_8c_ae28944d8adb2e0928f5005c2a3c8f68c}{event\+\_\+handler\+\_\+initialize} (const char $\ast$const event\+\_\+api\+\_\+url, const char $\ast$const throt\+\_\+api\+\_\+url, const char $\ast$const username, const char $\ast$const password, int verbosity)
\begin{DoxyCompactList}\small\item\em Initialize the event handler. \end{DoxyCompactList}\item 
\hyperlink{evel_8h_ae1f68b0d21fb98defcec46e99208a03e}{E\+V\+E\+L\+\_\+\+E\+R\+R\+\_\+\+C\+O\+D\+ES} \hyperlink{evel__event__mgr_8c_ae4bba8673b5047aa895bcc7ead3b52b3}{event\+\_\+handler\+\_\+run} ()
\begin{DoxyCompactList}\small\item\em Run the event handler. \end{DoxyCompactList}\item 
\hyperlink{evel_8h_ae1f68b0d21fb98defcec46e99208a03e}{E\+V\+E\+L\+\_\+\+E\+R\+R\+\_\+\+C\+O\+D\+ES} \hyperlink{evel__event__mgr_8c_af84510ba54ec3152a0be0d915ef10799}{event\+\_\+handler\+\_\+terminate} ()
\begin{DoxyCompactList}\small\item\em Terminate the event handler. \end{DoxyCompactList}\item 
\hyperlink{evel_8h_ae1f68b0d21fb98defcec46e99208a03e}{E\+V\+E\+L\+\_\+\+E\+R\+R\+\_\+\+C\+O\+D\+ES} \hyperlink{evel__event__mgr_8c_a209d2e5dbffe9e11ac79ae140f4a81bd}{evel\+\_\+post\+\_\+event} (\hyperlink{evel_8h_aa0ea94c675729365ea7825c4fc7e06d8}{E\+V\+E\+N\+T\+\_\+\+H\+E\+A\+D\+ER} $\ast$event)
\begin{DoxyCompactList}\small\item\em Post an event. \end{DoxyCompactList}\item 
size\+\_\+t \hyperlink{evel__event__mgr_8c_a1bb7d9765fc0f716b8c982920cfeca8c}{evel\+\_\+write\+\_\+callback} (void $\ast$contents, size\+\_\+t size, size\+\_\+t nmemb, void $\ast$userp)
\begin{DoxyCompactList}\small\item\em Callback function to provide returned data. \end{DoxyCompactList}\item 
void \hyperlink{evel__event__mgr_8c_ad0fdce42fc23778790f4be3a13d011fd}{evel\+\_\+handle\+\_\+event\+\_\+response} (const \hyperlink{evel__internal_8h_a552c2b2d2e73d39eb2d79328296f7d5f}{M\+E\+M\+O\+R\+Y\+\_\+\+C\+H\+U\+NK} $\ast$const chunk, \hyperlink{evel__internal_8h_a552c2b2d2e73d39eb2d79328296f7d5f}{M\+E\+M\+O\+R\+Y\+\_\+\+C\+H\+U\+NK} $\ast$const post)
\begin{DoxyCompactList}\small\item\em Handle a J\+S\+ON response from the listener, contained in a \hyperlink{evel__internal_8h_a552c2b2d2e73d39eb2d79328296f7d5f}{M\+E\+M\+O\+R\+Y\+\_\+\+C\+H\+U\+NK}. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Event Manager. 

Simple event manager that is responsible for taking events (Heartbeats, Faults and Measurements) from the ring-\/buffer and posting them to the A\+PI.

\subsubsection*{License }

Copyright(c) $<$2016$>$, AT\&T Intellectual Property. All other rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met\+:


\begin{DoxyEnumerate}
\item Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
\item Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
\item All advertising materials mentioning features or use of this software must display the following acknowledgement\+: This product includes software developed by the AT\&T.
\item Neither the name of AT\&T nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.
\end{DoxyEnumerate}

T\+H\+IS S\+O\+F\+T\+W\+A\+RE IS P\+R\+O\+V\+I\+D\+ED BY AT\&T I\+N\+T\+E\+L\+L\+E\+C\+T\+U\+AL P\+R\+O\+P\+E\+R\+TY \textquotesingle{}\textquotesingle{}AS IS\textquotesingle{}\textquotesingle{} A\+ND A\+NY E\+X\+P\+R\+E\+SS OR I\+M\+P\+L\+I\+ED W\+A\+R\+R\+A\+N\+T\+I\+ES, I\+N\+C\+L\+U\+D\+I\+NG, B\+UT N\+OT L\+I\+M\+I\+T\+ED TO, T\+HE I\+M\+P\+L\+I\+ED W\+A\+R\+R\+A\+N\+T\+I\+ES OF M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY A\+ND F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE A\+RE D\+I\+S\+C\+L\+A\+I\+M\+ED. IN NO E\+V\+E\+NT S\+H\+A\+LL AT\&T I\+N\+T\+E\+L\+L\+E\+C\+T\+U\+AL P\+R\+O\+P\+E\+R\+TY BE L\+I\+A\+B\+LE F\+OR A\+NY D\+I\+R\+E\+CT, I\+N\+D\+I\+R\+E\+CT, I\+N\+C\+I\+D\+E\+N\+T\+AL, S\+P\+E\+C\+I\+AL, E\+X\+E\+M\+P\+L\+A\+RY, OR C\+O\+N\+S\+E\+Q\+U\+E\+N\+T\+I\+AL D\+A\+M\+A\+G\+ES (I\+N\+C\+L\+U\+D\+I\+NG, B\+UT N\+OT L\+I\+M\+I\+T\+ED TO, P\+R\+O\+C\+U\+R\+E\+M\+E\+NT OF S\+U\+B\+S\+T\+I\+T\+U\+TE G\+O\+O\+DS OR S\+E\+R\+V\+I\+C\+ES; L\+O\+SS OF U\+SE, D\+A\+TA, OR P\+R\+O\+F\+I\+TS; OR B\+U\+S\+I\+N\+E\+SS I\+N\+T\+E\+R\+R\+U\+P\+T\+I\+ON) H\+O\+W\+E\+V\+ER C\+A\+U\+S\+ED A\+ND ON A\+NY T\+H\+E\+O\+RY OF L\+I\+A\+B\+I\+L\+I\+TY, W\+H\+E\+T\+H\+ER IN C\+O\+N\+T\+R\+A\+CT, S\+T\+R\+I\+CT L\+I\+A\+B\+I\+L\+I\+TY, OR T\+O\+RT (I\+N\+C\+L\+U\+D\+I\+NG N\+E\+G\+L\+I\+G\+E\+N\+CE OR O\+T\+H\+E\+R\+W\+I\+SE) A\+R\+I\+S\+I\+NG IN A\+NY W\+AY O\+UT OF T\+HE U\+SE OF T\+H\+IS S\+O\+F\+T\+W\+A\+RE, E\+V\+EN IF A\+D\+V\+I\+S\+ED OF T\+HE P\+O\+S\+S\+I\+B\+I\+L\+I\+TY OF S\+U\+CH D\+A\+M\+A\+GE. 

\subsection{Function Documentation}
\hypertarget{evel__event__mgr_8c_ad0fdce42fc23778790f4be3a13d011fd}{}\label{evel__event__mgr_8c_ad0fdce42fc23778790f4be3a13d011fd} 
\index{evel\+\_\+event\+\_\+mgr.\+c@{evel\+\_\+event\+\_\+mgr.\+c}!evel\+\_\+handle\+\_\+event\+\_\+response@{evel\+\_\+handle\+\_\+event\+\_\+response}}
\index{evel\+\_\+handle\+\_\+event\+\_\+response@{evel\+\_\+handle\+\_\+event\+\_\+response}!evel\+\_\+event\+\_\+mgr.\+c@{evel\+\_\+event\+\_\+mgr.\+c}}
\subsubsection{\texorpdfstring{evel\+\_\+handle\+\_\+event\+\_\+response()}{evel\_handle\_event\_response()}}
{\footnotesize\ttfamily void evel\+\_\+handle\+\_\+event\+\_\+response (\begin{DoxyParamCaption}\item[{const \hyperlink{evel__internal_8h_a552c2b2d2e73d39eb2d79328296f7d5f}{M\+E\+M\+O\+R\+Y\+\_\+\+C\+H\+U\+NK} $\ast$const}]{chunk,  }\item[{\hyperlink{evel__internal_8h_a552c2b2d2e73d39eb2d79328296f7d5f}{M\+E\+M\+O\+R\+Y\+\_\+\+C\+H\+U\+NK} $\ast$const}]{post }\end{DoxyParamCaption})}



Handle a J\+S\+ON response from the listener, contained in a \hyperlink{evel__internal_8h_a552c2b2d2e73d39eb2d79328296f7d5f}{M\+E\+M\+O\+R\+Y\+\_\+\+C\+H\+U\+NK}. 

Tokenize the response, and decode any tokens found.


\begin{DoxyParams}{Parameters}
{\em chunk} & The memory chunk containing the response. \\
\hline
{\em post} & The memory chunk in which to place any resulting P\+O\+ST. \\
\hline
\end{DoxyParams}


Definition at line 904 of file evel\+\_\+event\+\_\+mgr.\+c.

\hypertarget{evel__event__mgr_8c_a209d2e5dbffe9e11ac79ae140f4a81bd}{}\label{evel__event__mgr_8c_a209d2e5dbffe9e11ac79ae140f4a81bd} 
\index{evel\+\_\+event\+\_\+mgr.\+c@{evel\+\_\+event\+\_\+mgr.\+c}!evel\+\_\+post\+\_\+event@{evel\+\_\+post\+\_\+event}}
\index{evel\+\_\+post\+\_\+event@{evel\+\_\+post\+\_\+event}!evel\+\_\+event\+\_\+mgr.\+c@{evel\+\_\+event\+\_\+mgr.\+c}}
\subsubsection{\texorpdfstring{evel\+\_\+post\+\_\+event()}{evel\_post\_event()}}
{\footnotesize\ttfamily \hyperlink{evel_8h_ae1f68b0d21fb98defcec46e99208a03e}{E\+V\+E\+L\+\_\+\+E\+R\+R\+\_\+\+C\+O\+D\+ES} evel\+\_\+post\+\_\+event (\begin{DoxyParamCaption}\item[{\hyperlink{evel_8h_aa0ea94c675729365ea7825c4fc7e06d8}{E\+V\+E\+N\+T\+\_\+\+H\+E\+A\+D\+ER} $\ast$}]{event }\end{DoxyParamCaption})}



Post an event. 

\begin{DoxyNote}{Note}
So far as the caller is concerned, successfully posting the event relinquishes all responsibility for the event -\/ the library will take care of freeing the event in due course.
\end{DoxyNote}

\begin{DoxyParams}{Parameters}
{\em event} & The event to be posted.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status code 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em E\+V\+E\+L\+\_\+\+S\+U\+C\+C\+E\+SS} & On success \\
\hline
{\em One of \+::\+E\+V\+E\+L\+\_\+\+E\+R\+R\+\_\+\+C\+O\+D\+ES} & On failure. \\
\hline
\end{DoxyRetVals}


Definition at line 497 of file evel\+\_\+event\+\_\+mgr.\+c.

\hypertarget{evel__event__mgr_8c_a1bb7d9765fc0f716b8c982920cfeca8c}{}\label{evel__event__mgr_8c_a1bb7d9765fc0f716b8c982920cfeca8c} 
\index{evel\+\_\+event\+\_\+mgr.\+c@{evel\+\_\+event\+\_\+mgr.\+c}!evel\+\_\+write\+\_\+callback@{evel\+\_\+write\+\_\+callback}}
\index{evel\+\_\+write\+\_\+callback@{evel\+\_\+write\+\_\+callback}!evel\+\_\+event\+\_\+mgr.\+c@{evel\+\_\+event\+\_\+mgr.\+c}}
\subsubsection{\texorpdfstring{evel\+\_\+write\+\_\+callback()}{evel\_write\_callback()}}
{\footnotesize\ttfamily size\+\_\+t evel\+\_\+write\+\_\+callback (\begin{DoxyParamCaption}\item[{void $\ast$}]{contents,  }\item[{size\+\_\+t}]{size,  }\item[{size\+\_\+t}]{nmemb,  }\item[{void $\ast$}]{userp }\end{DoxyParamCaption})}



Callback function to provide returned data. 

Copy data into the supplied buffer, write\+\_\+callback\+::ptr, checking size limits.

\begin{DoxyReturn}{Returns}
Number of bytes placed into write\+\_\+callback\+::ptr. 0 for E\+OF. 
\end{DoxyReturn}


Definition at line 712 of file evel\+\_\+event\+\_\+mgr.\+c.

\hypertarget{evel__event__mgr_8c_ae28944d8adb2e0928f5005c2a3c8f68c}{}\label{evel__event__mgr_8c_ae28944d8adb2e0928f5005c2a3c8f68c} 
\index{evel\+\_\+event\+\_\+mgr.\+c@{evel\+\_\+event\+\_\+mgr.\+c}!event\+\_\+handler\+\_\+initialize@{event\+\_\+handler\+\_\+initialize}}
\index{event\+\_\+handler\+\_\+initialize@{event\+\_\+handler\+\_\+initialize}!evel\+\_\+event\+\_\+mgr.\+c@{evel\+\_\+event\+\_\+mgr.\+c}}
\subsubsection{\texorpdfstring{event\+\_\+handler\+\_\+initialize()}{event\_handler\_initialize()}}
{\footnotesize\ttfamily \hyperlink{evel_8h_ae1f68b0d21fb98defcec46e99208a03e}{E\+V\+E\+L\+\_\+\+E\+R\+R\+\_\+\+C\+O\+D\+ES} event\+\_\+handler\+\_\+initialize (\begin{DoxyParamCaption}\item[{const char $\ast$const}]{event\+\_\+api\+\_\+url,  }\item[{const char $\ast$const}]{throt\+\_\+api\+\_\+url,  }\item[{const char $\ast$const}]{username,  }\item[{const char $\ast$const}]{password,  }\item[{int}]{verbosity }\end{DoxyParamCaption})}



Initialize the event handler. 

Primarily responsible for getting C\+U\+RL ready for use.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em event\+\_\+api\+\_\+url} & The U\+RL where the Vendor Event Listener A\+PI is expected to be. \\
\hline
\mbox{\tt in}  & {\em throt\+\_\+api\+\_\+url} & The U\+RL where the Throttling A\+PI is expected to be. \\
\hline
\mbox{\tt in}  & {\em username} & The username for the Basic Authentication of requests. \\
\hline
\mbox{\tt in}  & {\em password} & The password for the Basic Authentication of requests. \\
\hline
 & {\em verbosity} & 0 for normal operation, positive values for chattier logs. \\
\hline
\end{DoxyParams}


Definition at line 133 of file evel\+\_\+event\+\_\+mgr.\+c.

\hypertarget{evel__event__mgr_8c_ae4bba8673b5047aa895bcc7ead3b52b3}{}\label{evel__event__mgr_8c_ae4bba8673b5047aa895bcc7ead3b52b3} 
\index{evel\+\_\+event\+\_\+mgr.\+c@{evel\+\_\+event\+\_\+mgr.\+c}!event\+\_\+handler\+\_\+run@{event\+\_\+handler\+\_\+run}}
\index{event\+\_\+handler\+\_\+run@{event\+\_\+handler\+\_\+run}!evel\+\_\+event\+\_\+mgr.\+c@{evel\+\_\+event\+\_\+mgr.\+c}}
\subsubsection{\texorpdfstring{event\+\_\+handler\+\_\+run()}{event\_handler\_run()}}
{\footnotesize\ttfamily \hyperlink{evel_8h_ae1f68b0d21fb98defcec46e99208a03e}{E\+V\+E\+L\+\_\+\+E\+R\+R\+\_\+\+C\+O\+D\+ES} event\+\_\+handler\+\_\+run (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Run the event handler. 

Spawns the thread responsible for handling events and sending them to the A\+PI.

\begin{DoxyReturn}{Returns}
Status code. 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em \hyperlink{evel_8h_ae1f68b0d21fb98defcec46e99208a03eaa9369500f041c2898e5c2b4f07b6d152}{E\+V\+E\+L\+\_\+\+S\+U\+C\+C\+E\+SS}} & if everything OK. \\
\hline
{\em One} & of \hyperlink{evel_8h_ae1f68b0d21fb98defcec46e99208a03e}{E\+V\+E\+L\+\_\+\+E\+R\+R\+\_\+\+C\+O\+D\+ES} if there was a problem. \\
\hline
\end{DoxyRetVals}


Definition at line 371 of file evel\+\_\+event\+\_\+mgr.\+c.

\hypertarget{evel__event__mgr_8c_af84510ba54ec3152a0be0d915ef10799}{}\label{evel__event__mgr_8c_af84510ba54ec3152a0be0d915ef10799} 
\index{evel\+\_\+event\+\_\+mgr.\+c@{evel\+\_\+event\+\_\+mgr.\+c}!event\+\_\+handler\+\_\+terminate@{event\+\_\+handler\+\_\+terminate}}
\index{event\+\_\+handler\+\_\+terminate@{event\+\_\+handler\+\_\+terminate}!evel\+\_\+event\+\_\+mgr.\+c@{evel\+\_\+event\+\_\+mgr.\+c}}
\subsubsection{\texorpdfstring{event\+\_\+handler\+\_\+terminate()}{event\_handler\_terminate()}}
{\footnotesize\ttfamily \hyperlink{evel_8h_ae1f68b0d21fb98defcec46e99208a03e}{E\+V\+E\+L\+\_\+\+E\+R\+R\+\_\+\+C\+O\+D\+ES} event\+\_\+handler\+\_\+terminate (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Terminate the event handler. 

Shuts down the event handler thread in as clean a way as possible. Sets the global exit flag and then signals the thread to interrupt it since it\textquotesingle{}s most likely waiting on the ring-\/buffer.

Having achieved an orderly shutdown of the event handler thread, clean up the c\+U\+RL library\textquotesingle{}s resources cleanly.

\begin{DoxyReturn}{Returns}
Status code. 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em \hyperlink{evel_8h_ae1f68b0d21fb98defcec46e99208a03eaa9369500f041c2898e5c2b4f07b6d152}{E\+V\+E\+L\+\_\+\+S\+U\+C\+C\+E\+SS}} & if everything OK. \\
\hline
{\em One} & of \hyperlink{evel_8h_ae1f68b0d21fb98defcec46e99208a03e}{E\+V\+E\+L\+\_\+\+E\+R\+R\+\_\+\+C\+O\+D\+ES} if there was a problem. \\
\hline
\end{DoxyRetVals}


Definition at line 408 of file evel\+\_\+event\+\_\+mgr.\+c.

